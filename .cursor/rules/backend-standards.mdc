---
description: 
globs: **/*.py", "!**/tests/**
alwaysApply: false
---
---
description: Python backend conventions
globs: ["**/*.py", "!**/tests/**"]
alwaysApply: false
---

- Use FastAPI `APIRouter` per domain (e.g. `users.router`).
- Annotate every endpoint with a **Pydantic v2 `BaseModel`** request/response.
- Database access = SQLAlchemy 2.0 core **async** sessions only.
- Background work → Celery task (`queue="default"` by default).
- Wrap outbound HTTP calls with tenacity retry (`wait_exponential`).

@templates/fastapi-endpoint.py
